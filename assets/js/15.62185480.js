(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{396:function(t,e,v){"use strict";v.r(e);var _=v(25),r=Object(_.a)({},(function(){var t=this,e=t.$createElement,v=t._self._c||e;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"数据库"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#数据库"}},[t._v("#")]),t._v(" 数据库 (Database)")]),t._v(" "),v("h2",{attrs:{id:"用户字段"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#用户字段"}},[t._v("#")]),t._v(" 用户字段")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",{staticStyle:{"text-align":"center"}},[t._v("字段名")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("id")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("number")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("数据库自动生成的 ID")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("cqhttp")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("QQ 号（由 adapter-cqhttp 提供）")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("tomon")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("Tomon ID（由 adapter-tomon 提供）")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("authority")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("number")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("权限等级")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("flag")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("number")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("状态标签")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("usage")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("Record<string, number>")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("调用记录")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("timers")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[v("code",[t._v("Record<string, number>")])]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("计时器")])])])]),t._v(" "),v("h2",{attrs:{id:"群字段"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#群字段"}},[t._v("#")]),t._v(" 群字段")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",{staticStyle:{"text-align":"center"}},[t._v("字段名")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("类型")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("描述")])])]),t._v(" "),v("tbody",[v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("id")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("群标识符")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("type")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("适配器名（如 cqhttp）")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("flag")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("number")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("状态标签")])]),t._v(" "),v("tr",[v("td",{staticStyle:{"text-align":"center"}},[t._v("assignee")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("string")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("代理者")])])])]),t._v(" "),v("h2",{attrs:{id:"频道字段"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#频道字段"}},[t._v("#")]),t._v(" 频道字段")]),t._v(" "),v("p",[t._v("待定。")]),t._v(" "),v("h2",{attrs:{id:"全局接口"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#全局接口"}},[t._v("#")]),t._v(" 全局接口")]),t._v(" "),v("h3",{attrs:{id:"user-flag"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#user-flag"}},[t._v("#")]),t._v(" User.Flag")]),t._v(" "),v("p",[t._v("所有用户状态标签构成的枚举类型。参见 "),v("RouterLink",{attrs:{to:"/guide/authorization.html#状态标签"}},[t._v("状态标签")]),t._v("。")],1),t._v(" "),v("h3",{attrs:{id:"user-fields"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#user-fields"}},[t._v("#")]),t._v(" User.fields")]),t._v(" "),v("p",[t._v("所有用户字段构成的列表。")]),t._v(" "),v("h3",{attrs:{id:"user-extend"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#user-extend"}},[t._v("#")]),t._v(" User.extend(getter)")]),t._v(" "),v("p",[t._v("扩展用户字段。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("getter:")]),t._v(" "),v("code",[t._v("(kind: string, id: number, authority: number) => object")]),t._v(" 新字段的初始化函数，返回值应该是一个由要扩展的字段和它们的默认值构成的键值对")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("void")])])]),t._v(" "),v("h3",{attrs:{id:"user-create"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#user-create"}},[t._v("#")]),t._v(" User.create(id, authority)")]),t._v(" "),v("p",[t._v("创建一个新用户数据对象。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("id:")]),t._v(" "),v("code",[t._v("number")]),t._v(" 用户 ID")]),t._v(" "),v("li",[v("strong",[t._v("authority:")]),t._v(" "),v("code",[t._v("number")]),t._v(" 权限等级")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("User")])])]),t._v(" "),v("h3",{attrs:{id:"group-flag"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#group-flag"}},[t._v("#")]),t._v(" Group.Flag")]),t._v(" "),v("p",[t._v("所有群状态标签构成的枚举类型。参见 "),v("RouterLink",{attrs:{to:"/guide/authorization.html#状态标签"}},[t._v("状态标签")]),t._v("。")],1),t._v(" "),v("h3",{attrs:{id:"group-fields"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#group-fields"}},[t._v("#")]),t._v(" Group.fields")]),t._v(" "),v("p",[t._v("所有群字段构成的列表。")]),t._v(" "),v("h3",{attrs:{id:"group-extend"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#group-extend"}},[t._v("#")]),t._v(" Group.extend(getter)")]),t._v(" "),v("p",[t._v("扩展群字段。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("getter:")]),t._v(" "),v("code",[t._v("(id: number, assignee: number) => object")]),t._v(" 新字段的初始化函数，返回值应该是一个由要扩展的字段和它们的默认值构成的键值对")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("void")])])]),t._v(" "),v("h3",{attrs:{id:"group-create"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#group-create"}},[t._v("#")]),t._v(" Group.create(id, assignee)")]),t._v(" "),v("p",[t._v("创建一个新群数据对象。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("id:")]),t._v(" "),v("code",[t._v("number")]),t._v(" 用户 ID")]),t._v(" "),v("li",[v("strong",[t._v("assignee:")]),t._v(" "),v("code",[t._v("number")]),t._v(" 代理者的 ID")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("Group")])])]),t._v(" "),v("h3",{attrs:{id:"extenddatabase"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#extenddatabase"}},[t._v("#")]),t._v(" extendDatabase(database, extension)")]),t._v(" "),v("p",[t._v("扩展一个数据库的方法。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("database:")]),t._v(" "),v("code",[t._v("string | (new () => Database)")]),t._v(" 要扩展的数据库类；如果传入一个字符串，则会将这个模块的默认导出作为目标类")]),t._v(" "),v("li",[v("strong",[t._v("extension:")]),t._v(" "),v("code",[t._v("Partial<Database>")]),t._v(" 要添加到原型链的方法")])]),t._v(" "),v("h2",{attrs:{id:"数据库对象"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#数据库对象"}},[t._v("#")]),t._v(" 数据库对象")]),t._v(" "),v("p",[t._v("一个 Database 对象代理了 Koishi 上下文绑定的应用实例有关的所有数据库访问。同时它具有注入特性，任何插件都可以自己定义数据库上的方法。本章主要介绍数据库的官方接口。注意："),v("strong",[t._v("它们并不由 Koishi 自身实现，而是由每个数据库分别实现的")]),t._v("。Koishi 只是提供了一套标准。")]),t._v(" "),v("h3",{attrs:{id:"db-getuser"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#db-getuser"}},[t._v("#")]),t._v(" db.getUser(type, id, fields?)")]),t._v(" "),v("p",[t._v("向数据库请求用户数据。如果传入的 id 是一个列表，则返回值也应当是一个列表。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("type:")]),t._v(" "),v("code",[t._v("string")]),t._v(" 平台名")]),t._v(" "),v("li",[v("strong",[t._v("id:")]),t._v(" "),v("code",[t._v("string | string")]),t._v(" 用户标识符")]),t._v(" "),v("li",[v("strong",[t._v("fields:")]),t._v(" "),v("code",[t._v("UserField[]")]),t._v(" 请求的字段，默认为全部字段")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("Promise<User | User[]>")]),t._v(" 用户数据")])]),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("提示")]),t._v(" "),v("p",[t._v("尽管这里我们提供了 "),v("code",[t._v("fields")]),t._v(" 参数用于对特定的数据库进行优化，但是如果你是数据库开发者，也完全可以忽略这个参数。只需要保证返回的数据满足用户数据格式，且包含在 "),v("code",[t._v("fields")]),t._v(" 中的字段都存在即可。")])]),t._v(" "),v("h3",{attrs:{id:"db-getusers"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#db-getusers"}},[t._v("#")]),t._v(" db.getUsers(type, ids?, fields?)")]),t._v(" "),v("p",[t._v("向数据库请求多位用户数据。如果数据不存在，则不会在返回的列表中。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("type:")]),t._v(" "),v("code",[t._v("string")]),t._v(" 平台名")]),t._v(" "),v("li",[v("strong",[t._v("ids:")]),t._v(" "),v("code",[t._v("string[]")]),t._v(" 用户标识符列表，默认为全部用户")]),t._v(" "),v("li",[v("strong",[t._v("fields:")]),t._v(" "),v("code",[t._v("UserField[]")]),t._v(" 请求的字段，默认为全部字段")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("Promise<User[]>")]),t._v(" 用户数据列表")])]),t._v(" "),v("h3",{attrs:{id:"db-setuser"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#db-setuser"}},[t._v("#")]),t._v(" db.setUser(type, id, data)")]),t._v(" "),v("p",[t._v("向数据库写入用户数据。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("type:")]),t._v(" "),v("code",[t._v("string")]),t._v(" 平台名")]),t._v(" "),v("li",[v("strong",[t._v("id:")]),t._v(" "),v("code",[t._v("string")]),t._v(" 用户标识符")]),t._v(" "),v("li",[v("strong",[t._v("data:")]),t._v(" "),v("code",[t._v("User")]),t._v(" 要修改的数据（如果设置为 "),v("code",[t._v("null")]),t._v(" 则清除该用户数据）")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("Promise<void>")])])]),t._v(" "),v("h3",{attrs:{id:"db-getgroup"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#db-getgroup"}},[t._v("#")]),t._v(" db.getGroup(type, id, fields?)")]),t._v(" "),v("p",[t._v("向数据库请求群数据。如果传入的 id 是一个列表，则返回值也应当是一个列表。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("type:")]),t._v(" "),v("code",[t._v("string")]),t._v(" 平台名")]),t._v(" "),v("li",[v("strong",[t._v("id:")]),t._v(" "),v("code",[t._v("string | string[]")]),t._v(" 群标识符")]),t._v(" "),v("li",[v("strong",[t._v("fields:")]),t._v(" "),v("code",[t._v("GroupField[]")]),t._v(" 请求的字段，默认为全部字段")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("Promise<Group | Group[]>")]),t._v(" 群数据")])]),t._v(" "),v("h3",{attrs:{id:"db-getgrouplist"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#db-getgrouplist"}},[t._v("#")]),t._v(" db.getGroupList(fields?, type?, assignees?)")]),t._v(" "),v("p",[t._v("向数据库请求被特定机器人管理的所有群数据。这里的两个参数可以写任意一个，都可以识别。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("fields:")]),t._v(" "),v("code",[t._v("GroupField[]")]),t._v(" 请求的字段，默认为全部字段")]),t._v(" "),v("li",[v("strong",[t._v("type:")]),t._v(" "),v("code",[t._v("string")]),t._v(" 平台名，默认为全平台")]),t._v(" "),v("li",[v("strong",[t._v("assignees:")]),t._v(" "),v("code",[t._v("string[]")]),t._v(" 代理者列表，默认为当前运行的全部机器人")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("Promise<Group[]>")]),t._v(" 群数据列表")])]),t._v(" "),v("h3",{attrs:{id:"db-setgroup"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#db-setgroup"}},[t._v("#")]),t._v(" db.setGroup(type, id, data)")]),t._v(" "),v("p",[t._v("向数据库写入群数据。")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("type:")]),t._v(" "),v("code",[t._v("string")]),t._v(" 平台名")]),t._v(" "),v("li",[v("strong",[t._v("id:")]),t._v(" "),v("code",[t._v("number")]),t._v(" 群标识符")]),t._v(" "),v("li",[v("strong",[t._v("data:")]),t._v(" "),v("code",[t._v("Group")]),t._v(" 要修改的数据")]),t._v(" "),v("li",[t._v("返回值: "),v("code",[t._v("Promise<void>")])])])])}),[],!1,null,null,null);e.default=r.exports}}]);