(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{392:function(t,s,o){"use strict";o.r(s);var e=o(25),v=Object(e.a)({},(function(){var t=this,s=t.$createElement,o=t._self._c||s;return o("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[o("h1",{attrs:{id:"应用"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#应用"}},[t._v("#")]),t._v(" 应用 (App)")]),t._v(" "),o("p",[o("strong",[t._v("应用 (App)")]),t._v(" 是 "),o("RouterLink",{attrs:{to:"/api/context.html"}},[t._v("Context")]),t._v(" 的一个子类，它是程序的入口，管理着全部机器人的信息。除了 Context 中已有的属性和方法以外，App 还提供了下面的属性和方法：")],1),t._v(" "),o("h2",{attrs:{id:"构造函数选项"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#构造函数选项"}},[t._v("#")]),t._v(" 构造函数选项")]),t._v(" "),o("p",[t._v("通过 "),o("code",[t._v("new App(options)")]),t._v(" 创建一个 App 实例。")]),t._v(" "),o("h3",{attrs:{id:"options-type"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-type"}},[t._v("#")]),t._v(" options.type")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("string")])])]),t._v(" "),o("p",[t._v("机器人的通信方式，对应你所使用的上游协议，例如 "),o("code",[t._v("cqhttp")]),t._v(" 或 "),o("code",[t._v("atri")]),t._v(" 等。")]),t._v(" "),o("h3",{attrs:{id:"options-port"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-port"}},[t._v("#")]),t._v(" options.port")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number")])])]),t._v(" "),o("p",[t._v("服务器监听的端口。")]),t._v(" "),o("h3",{attrs:{id:"options-bots"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-bots"}},[t._v("#")]),t._v(" options.bots")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("BotOptions[]")])])]),t._v(" "),o("p",[t._v("账号相关配置。如果你使用多个账号，这里应该传入一个数组。例如下面的写法是等价的：")]),t._v(" "),o("panel-view",{staticClass:"code",attrs:{title:""}},[o("pre",{staticClass:"shiki",staticStyle:{"background-color":"#272822"}},[o("code",[o("span",{staticStyle:{color:"#F92672"}},[t._v("new")]),o("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),o("span",{staticStyle:{color:"#A6E22E"}},[t._v("App")]),o("span",{staticStyle:{color:"#F8F8F2"}},[t._v("({ selfId: ")]),o("span",{staticStyle:{color:"#AE81FF"}},[t._v("123")]),o("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" })")]),t._v("\n\n"),o("span",{staticStyle:{color:"#F92672"}},[t._v("new")]),o("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" ")]),o("span",{staticStyle:{color:"#A6E22E"}},[t._v("App")]),o("span",{staticStyle:{color:"#F8F8F2"}},[t._v("({")]),t._v("\n"),o("span",{staticStyle:{color:"#F8F8F2"}},[t._v("  bots: [{ selfId: ")]),o("span",{staticStyle:{color:"#AE81FF"}},[t._v("123")]),o("span",{staticStyle:{color:"#F8F8F2"}},[t._v(" }],")]),t._v("\n"),o("span",{staticStyle:{color:"#F8F8F2"}},[t._v("})")])])])]),o("h3",{attrs:{id:"options-bots-selfid"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-bots-selfid"}},[t._v("#")]),t._v(" options(.bots[]).selfId")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number")])])]),t._v(" "),o("p",[t._v("机器人自己的 QQ 号。")]),t._v(" "),o("h3",{attrs:{id:"options-nickname"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-nickname"}},[t._v("#")]),t._v(" options.nickname")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("string | string[]")])])]),t._v(" "),o("p",[t._v("机器人的昵称，可以是字符串或字符串数组。将用于指令前缀的匹配。例如，如果配置该选项为 "),o("code",[t._v("'恋恋'")]),t._v("，则你可以通过 "),o("code",[t._v("恋恋，help")]),t._v(" 来进行 help 指令的调用。参见 "),o("RouterLink",{attrs:{to:"/guide/command-system.html#指令前缀"}},[o("strong",[t._v("指令前缀")])]),t._v(" 一节。")],1),t._v(" "),o("h3",{attrs:{id:"options-prefix"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-prefix"}},[t._v("#")]),t._v(" options.prefix")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("string | string[]")])])]),t._v(" "),o("p",[t._v("指令前缀字符，可以是字符串或字符串数组。将用于指令前缀的匹配。例如，如果配置该选项为 "),o("code",[t._v(".")]),t._v("，则你可以通过 "),o("code",[t._v(".help")]),t._v(" 来进行 help 指令的调用。参见 "),o("RouterLink",{attrs:{to:"/guide/command-system.html#指令前缀"}},[o("strong",[t._v("指令前缀")])]),t._v(" 一节。")],1),t._v(" "),o("h3",{attrs:{id:"options-maxlisteners"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-maxlisteners"}},[t._v("#")]),t._v(" options.maxListeners")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number")])])]),t._v(" "),o("p",[t._v("每种钩子的最大数量。如果超过这个数量，Koishi 会认定为发生了内存泄漏，将产生一个警告。默认值为 "),o("code",[t._v("64")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-processmessage"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-processmessage"}},[t._v("#")]),t._v(" options.processMessage")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("(message: string) => string")])])]),t._v(" "),o("p",[t._v("对消息进行提前处理的方式，它将直接作用与 "),o("code",[t._v("session.message")]),t._v("。默认值为 "),o("code",[t._v("message => simplify(message.trim())")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-defaultauthority"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-defaultauthority"}},[t._v("#")]),t._v(" options.defaultAuthority")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number | ((session: Session) => number)")])])]),t._v(" "),o("p",[t._v("当获取不到用户数据时默认使用的权限等级。")]),t._v(" "),o("h3",{attrs:{id:"options-queuedelay"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-queuedelay"}},[t._v("#")]),t._v(" options.queueDelay")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number | ((message: string, session: Session) => number)")])])]),t._v(" "),o("p",[o("code",[t._v("session.$sendQueued")]),t._v(" 的默认延迟时间，单位为毫秒。默认值为 "),o("code",[t._v("100")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-prompttimeout"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-prompttimeout"}},[t._v("#")]),t._v(" options.promptTimeout")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number")])])]),t._v(" "),o("p",[o("code",[t._v("session.$prompt")]),t._v(" 的默认等待时间，单位为毫秒。默认值为 "),o("code",[t._v("60000")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-prettyerrors"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-prettyerrors"}},[t._v("#")]),t._v(" options.prettyErrors")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("boolean")])])]),t._v(" "),o("p",[t._v("启用报错优化模式。在此模式下 Koishi 会对程序抛出的异常进行整理，过滤掉框架内部的调用记录，输出更易读的提示信息。默认值为 "),o("code",[t._v("true")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-similaritycoefficient"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-similaritycoefficient"}},[t._v("#")]),t._v(" options.similarityCoefficient")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number")])])]),t._v(" "),o("p",[t._v("用于模糊匹配的相似系数，应该是一个 0 到 1 之间的数值。数值越高，模糊匹配越严格。设置为 1 可以完全禁用模糊匹配。参见 "),o("RouterLink",{attrs:{to:"/guide/command-system.html#模糊匹配"}},[o("strong",[t._v("模糊匹配")])]),t._v(" 一节。")],1),t._v(" "),o("h2",{attrs:{id:"cqhttp-选项"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cqhttp-选项"}},[t._v("#")]),t._v(" CQHTTP 选项")]),t._v(" "),o("p",[t._v("下面的配置项来自 koishi-adapter-cqhttp。你需要将你的 "),o("a",{attrs:{href:"#options-type"}},[o("code",[t._v("type")])]),t._v(" 字段配置为 "),o("code",[t._v("cqhttp")]),t._v(", "),o("code",[t._v("cqhttp:http")]),t._v(", "),o("code",[t._v("cqhttp:ws")]),t._v(" 或 "),o("code",[t._v("cqhttp:ws-reverse")]),t._v(" 中的一种。如果缺省或使用了 "),o("code",[t._v("cqhttp")]),t._v("，Koishi 会读取你的 "),o("code",[t._v("server")]),t._v(" 选项，根据你配置的服务器 URL 进行适配。")]),t._v(" "),o("p",[t._v("相关 CQHTTP 配置："),o("code",[t._v("use_http")]),t._v(", "),o("code",[t._v("use_ws")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-path"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-path"}},[t._v("#")]),t._v(" options.path")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("string")])])]),t._v(" "),o("p",[t._v("服务器监听的路径。相关 CQHTTP 配置："),o("code",[t._v("post_url")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-secret"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-secret"}},[t._v("#")]),t._v(" options.secret")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("string")])])]),t._v(" "),o("p",[t._v("接收信息时用于验证的字段，应与 CQHTTP 的 "),o("code",[t._v("secret")]),t._v(" 配置保持一致。")]),t._v(" "),o("h3",{attrs:{id:"options-bots-server"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-bots-server"}},[t._v("#")]),t._v(" options(.bots[]).server")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("string")])])]),t._v(" "),o("p",[t._v("如果使用了 HTTP，则该配置将作为发送信息的服务端；如果使用了 WebSocket，则该配置将作为监听事件和发送信息的服务端。")]),t._v(" "),o("p",[t._v("相关 CQHTTP 配置："),o("code",[t._v("host")]),t._v(", "),o("code",[t._v("port")]),t._v(", "),o("code",[t._v("ws_host")]),t._v(", "),o("code",[t._v("ws_port")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-bots-token"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-bots-token"}},[t._v("#")]),t._v(" options(.bots[]).token")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("string")])])]),t._v(" "),o("p",[t._v("发送信息时用于验证的字段，应与 CQHTTP 的 "),o("code",[t._v("access_token")]),t._v(" 配置保持一致。")]),t._v(" "),o("h3",{attrs:{id:"options-retrytimes"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-retrytimes"}},[t._v("#")]),t._v(" options.retryTimes")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number")])])]),t._v(" "),o("p",[t._v("WebSocket 允许重新连接的次数。默认值为 "),o("code",[t._v("0")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-retryinterval"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-retryinterval"}},[t._v("#")]),t._v(" options.retryInterval")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number")])])]),t._v(" "),o("p",[t._v("WebSocket 重新尝试连接前的等待时间，单位为毫秒。默认值为 "),o("code",[t._v("5000")]),t._v("。")]),t._v(" "),o("h3",{attrs:{id:"options-quickoperation"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-quickoperation"}},[t._v("#")]),t._v(" options.quickOperation")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number")])])]),t._v(" "),o("p",[t._v("快捷操作的时间限制，单位为毫秒。如果配置了这个选项且使用了 HTTP 通信方式，则在这段时间内的首次调用 "),o("code",[t._v("meta.$send()")]),t._v(" 或类似的方法将不产生新的 HTTP 请求。默认值为 "),o("code",[t._v("100")]),t._v("。参见 "),o("RouterLink",{attrs:{to:"/guide/message.html#快捷操作"}},[o("strong",[t._v("快捷操作")])]),t._v(" 一节。")],1),t._v(" "),o("h2",{attrs:{id:"cli-选项"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#cli-选项"}},[t._v("#")]),t._v(" CLI 选项")]),t._v(" "),o("p",[t._v("下面的配置项来自 koishi 的命令行工具。")]),t._v(" "),o("h3",{attrs:{id:"options-plugins"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-plugins"}},[t._v("#")]),t._v(" options.plugins")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("[Plugin<T>, T][]")])])]),t._v(" "),o("p",[t._v("要安装的插件列表。如果传入一个列表，则依次安装列表中的插件；如果传入一个对象，则以对象的键为上下文依次注册对应的值中的插件。参见 "),o("RouterLink",{attrs:{to:"/guide/plugin-and-context.html"}},[o("strong",[t._v("插件与上下文")])]),t._v(" 一章。")],1),t._v(" "),o("h3",{attrs:{id:"options-loglevel"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-loglevel"}},[t._v("#")]),t._v(" options.logLevel")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("number")])])]),t._v(" "),o("p",[t._v("默认的输出等级。默认值为 "),o("code",[t._v("2")]),t._v("。参见 "),o("RouterLink",{attrs:{to:"/guide/logger.html#设置输出等级"}},[o("strong",[t._v("设置输出等级")])]),t._v(" 一节。")],1),t._v(" "),o("h3",{attrs:{id:"options-logfilter"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#options-logfilter"}},[t._v("#")]),t._v(" options.logFilter")]),t._v(" "),o("ul",[o("li",[t._v("类型："),o("code",[t._v("Record<string, number>")])])]),t._v(" "),o("p",[t._v("用于在某些范围覆盖默认的输出等级。参见 "),o("RouterLink",{attrs:{to:"/guide/logger.html#过滤输出"}},[o("strong",[t._v("过滤输出")])]),t._v(" 一节。")],1),t._v(" "),o("h2",{attrs:{id:"app-options"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#app-options"}},[t._v("#")]),t._v(" app.options")]),t._v(" "),o("p",[t._v("当前 App 创建时传入的配置。")]),t._v(" "),o("h2",{attrs:{id:"app-status"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#app-status"}},[t._v("#")]),t._v(" app.status")]),t._v(" "),o("p",[t._v("当前 App 的运行状态。它可能是下列数值中的一个：")]),t._v(" "),o("ul",[o("li",[t._v("Status.closed = 0")]),t._v(" "),o("li",[t._v("Status.opening = 1")]),t._v(" "),o("li",[t._v("Status.open = 2")]),t._v(" "),o("li",[t._v("Status.closing = 3")])]),t._v(" "),o("h2",{attrs:{id:"app-start"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#app-start"}},[t._v("#")]),t._v(" app.start()")]),t._v(" "),o("p",[t._v("启动此应用。")]),t._v(" "),o("ul",[o("li",[t._v("返回值: "),o("code",[t._v("Promise<void>")])])]),t._v(" "),o("h2",{attrs:{id:"app-stop"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#app-stop"}},[t._v("#")]),t._v(" app.stop()")]),t._v(" "),o("p",[t._v("停止此应用。")]),t._v(" "),o("ul",[o("li",[t._v("返回值: "),o("code",[t._v("Promise<void>")])])]),t._v(" "),o("h2",{attrs:{id:"app-getselfids"}},[o("a",{staticClass:"header-anchor",attrs:{href:"#app-getselfids"}},[t._v("#")]),t._v(" app.getSelfIds()")]),t._v(" "),o("p",[t._v("获取所有机器人的 QQ 号。已经获取到的将不再获取。无法连接的服务器的账号将不会返回。")]),t._v(" "),o("ul",[o("li",[t._v("返回值: "),o("code",[t._v("Promise<number[]>")]),t._v(" 所有机器人的 QQ 号")])])],1)}),[],!1,null,null,null);s.default=v.exports}}]);